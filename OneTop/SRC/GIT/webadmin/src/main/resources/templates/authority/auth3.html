<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout">
<head>
<title th:text="#{auth3.title}"></title>
<th:block layout:fragment="css">

</th:block>
</head>
<body>
<!-- leftMenu -->
<div layout:fragment="menu">
    <div th:replace="include/menu :: authority"></div>
</div>
<!-- //leftMenu -->
<div layout:fragment="content">
    <div class="contSection">
        <h2 class="tit_h2" th:text="#{auth3.h2}"></h2>

        <style type="text/css">
            .authorityList table tbody td {text-align:left;font-size:12px;padding-left:10px;height:34px;border-left:0;}
            .authorityList table tbody td.step1 {font-weight:bold;background-color: #fed2b5;}
            .authorityList table tbody tr td:first-child {text-align:center;padding:0;}
            .admin_menu { width: 270px !important;border-right: 3px solid #ddd !important;}
            .admin_list {height: 1413px;  overflow-x: auto; overflow-y:hidden; border-right: 3px solid #ddd !important;}
            .admin_list table { float:left;width:105px;}
            .admin_list table thead tr th {word-break:break-all;line-height: 16px;padding: 2px 7px 0 7px;height: 40px;font-size:13px;}
            .admin_list table thead tr td {font-size: 12px;padding-left: 10px;height: 34px;}
            .admin_list table tbody tr td input { width:15px;height:15px;opacity:initial !important;position:initial !important;margin: 0 !important;}
        </style>

        <div class="tableStyle authorityList aCenter mb20" style="display: flex;">
            <table class="admin_menu">
                <colgroup>
                    <col style="width: 60px;" />
                    <col style="width: 30px" />
                    <col style="width: 30px;" />
                    <col style="width: 150px;" />
                </colgroup>
                <thead>
                    <tr>
                        <th>Code</th>
                        <th colspan="3">Menu</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="step1">ZA01</td>
                        <td colspan="3" class="step1">모니터링</td>
                    </tr>
                    <tr>
                        <td>ZA11</td>
                        <td></td>
                        <td colspan="2">dashboard</td>
                    </tr>
                    <tr>
                        <td class="step1">ZB00</td>
                        <td colspan="3" class="step1">시스템관리</td>
                    </tr>
                    <tr>
                        <td>ZB10</td>
                        <td></td>
                        <td colspan="2">투자관리</td>
                    </tr>
                    <tr>
                        <td>ZB11</td>
                        <td colspan="2"></td>
                        <td>투자/회수 수수료</td>
                    </tr>
                    <tr>
                        <td>ZB12</td>
                        <td colspan="2"></td>
                        <td>투자 비율설정</td>
                    </tr>
                    <tr>
                        <td>ZB20</td>
                        <td></td>
                        <td colspan="2">입출금 관리</td>
                    </tr>
                    <tr>
                        <td>ZB21</td>
                        <td colspan="2"></td>
                        <td>출금 수수료</td>
                    </tr>
                    <tr>
                        <td>ZB22</td>
                        <td colspan="2"></td>
                        <td>입출금 설정</td>
                    </tr>
                    <tr>
                        <td>ZB30</td>
                        <td></td>
                        <td colspan="2">수당지급 관리</td>
                    </tr>
                    <tr>
                        <td>ZB31</td>
                        <td colspan="2"></td>
                        <td>기본수당</td>
                    </tr>
                    <tr>
                        <td>ZB32</td>
                        <td colspan="2"></td>
                        <td>후원수당</td>
                    </tr>
                    <tr>
                        <td>ZB33</td>
                        <td colspan="2"></td>
                        <td>장려수당</td>
                    </tr>
                    <tr>
                        <td>ZB34</td>
                        <td colspan="2"></td>
                        <td>직급수당</td>
                    </tr>
                    <tr>
                        <td>ZB41</td>
                        <td></td>
                        <td colspan="2">스냅샷 정보</td>
                    </tr>
                    <tr>
                        <td>ZB51</td>
                        <td></td>
                        <td colspan="2">시스템 변경 log</td>
                    </tr>
                    <tr>
                        <td class="step1">ZC00</td>
                        <td colspan="3" class="step1">회원관리</td>
                    </tr>
                    <tr>
                        <td>ZC11</td>
                        <td></td>
                        <td colspan="2">회원 상세정보</td>
                    </tr>
                    <tr>
                        <td>ZC20</td>
                        <td></td>
                        <td colspan="2">회원관리</td>
                    </tr>
                    <tr>
                        <td>ZC21</td>
                        <td colspan="2"></td>
                        <td>회원 검색</td>
                    </tr>
                    <tr>
                        <td>ZC22</td>
                        <td colspan="2"></td>
                        <td>블랙 컨슈머</td>
                    </tr>
                    <tr>
                        <td>ZC23</td>
                        <td colspan="2"></td>
                        <td>회원 로그인 정보</td>
                    </tr>
                    <tr>
                        <td>ZC30</td>
                        <td></td>
                        <td colspan="2">관리자 지급/회수</td>
                    </tr>
                    <tr>
                        <td>ZC31</td>
                        <td colspan="2"></td>
                        <td>개별 지급/회수</td>
                    </tr>
                    <tr>
                        <td>ZC32</td>
                        <td colspan="2"></td>
                        <td>전체 지급/회수</td>
                    </tr>
                    <tr>
                        <td>ZC40</td>
                        <td></td>
                        <td colspan="2">회원자산log</td>
                    </tr>
                    <tr>
                        <td>ZC41</td>
                        <td colspan="2"></td>
                        <td>회원 자산</td>
                    </tr>
                    <tr>
                        <td>ZC42</td>
                        <td colspan="2"></td>
                        <td>관리자 지급/회수</td>
                    </tr>
                    <tr>
                        <td class="step1">ZD00</td>
                        <td colspan="3" class="step1">입출금 관리</td>
                    </tr>
                    <tr>
                        <td>ZD10</td>
                        <td></td>
                        <td colspan="2">입금 관리</td>
                    </tr>
                    <tr>
                        <td>ZD11</td>
                        <td colspan="2"></td>
                        <td>암호화폐 입금 현황</td>
                    </tr>
                    <tr>
                        <td>ZD20</td>
                        <td></td>
                        <td colspan="2">출금 관리</td>
                    </tr>
                    <tr>
                        <td>ZD21</td>
                        <td colspan="2"></td>
                        <td>암호화폐 출금 현황</td>
                    </tr>
                    <tr>
                        <td>ZD31</td>
                        <td colspan="2"></td>
                        <td>출금 요청</td>
                    </tr>
                    <tr>
                        <td>ZD41</td>
                        <td colspan="2"></td>
                        <td>출금 완료</td>
                    </tr>
                    <tr>
                        <td class="step1">ZE01</td>
                        <td colspan="3" class="step1">게시판관리</td>
                    </tr>
                    <tr>
                        <td>ZE11</td>
                        <td></td>
                        <td colspan="2">공지사항</td>
                    </tr>
                    <tr>
                        <td>ZE21</td>
                        <td></td>
                        <td colspan="2">배너관리</td>
                    </tr>
                    <tr>
                        <td class="step1">ZF01</td>
                        <td colspan="3" class="step1">권한관리</td>
                    </tr>
                    <tr>
                        <td>ZF11</td>
                        <td></td>
                        <td colspan="2">접근권한 관리</td>
                    </tr>
                    <tr>
                        <td>ZF21</td>
                        <td></td>
                        <td colspan="2">접근권한 상세관리</td>
                    </tr>
                    <tr>
                        <td>ZF31</td>
                        <td></td>
                        <td colspan="2">관리자 log</td>
                    </tr>
                </tbody>
            </table>
            <div class="admin_list">
                <form id="admininfo">
                    <div th:style="|width:${#lists.size(adminMemberResponse.adminMemberList)*105}px;|">
                        <th:block th:each="adminMember, index : ${adminMemberResponse.adminMemberList}">
                        <table>
                            <thead>
                            <tr>
                                <th th:text="${adminMember.id}"></th>
                                <input type="hidden" name="adminid" th:value="|${adminMember.id}!!!|" />
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="authlist : ${#strings.arraySplit(adminMember.security_proposal, 'Z')}">
                                <td th:if="${#strings.substring(authlist,3,4)}==1">
                                    <input type="checkbox" th:name="|authcode${index.index}|" th:value="|Z${authlist}|" checked />
                                </td>
                                <td th:unless="${#strings.substring(authlist,3,4)}==1">
                                    <input type="checkbox" th:name="|authcode${index.index}|" th:value="|Z${authlist}|" />
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        </th:block>
                    </div>
                </form>
            </div>

        </div>
        <div class="buttonRight">
            <a href="javascript: authAdminMember();" class="btnType" th:text="#{save.btn}"></a>
        </div>
    </div>
    <!-- //contSection -->
</div>
<!-- //contents -->
<th:block layout:fragment="side"></th:block>
<th:block layout:fragment="script">
<script type="text/javascript" src="/js/include/menu_authority.js"></script>
<script type="text/javascript" src="/js/authority/auth1.js"></script>
<script type="text/javascript">
    function admin_list() {
        $('.admin_list').attr("style", "width:"+($(window).width()-600)+"px !important");
    }
    admin_list();
    $(window).resize(function () {
        admin_list();
    });
    function authAdminMember() {
        $('#admininfo').find('[type=checkbox]').prop('checked','checked');
        var formdata = $('#admininfo').serialize();
        var param;
        for(var i=0;i<100;i++) {
            param = "&authcode"+i+"=";
            if(formdata.indexOf(param)>-1) {
                var searchReg = new RegExp(param, "g");
                formdata = formdata.replace(searchReg, "");
            }else{
                break;
            }
        }

        $.ajax({
            url: '/auth3/edit',
            type: 'POST',
            data: formdata,
            async: false,
            success: function(data) {
                if(data == "ok") {
                    location.href='auth3';
                }
            }
        });
    }

    $('#admininfo').find('input').click(function() {
        var str = $(this).val();
        var strArray = [str.substr(1,1), str.substr(2,1), str.substr(3,1),str.substr(0,4)];
        $(this).val($(this).is(":checked")?strArray[3]+"1":strArray[3]+"0");
        console.log(strArray);
        if(strArray[2]=="0") {
            var selectMenu = $(this).is(":checked");
            $('#admininfo').find('input[name='+$(this).attr('name')+'][value^=Z'+((strArray[1]=="0")?strArray[0]:strArray[0]+strArray[1])+']').each(function(){
                if($(this).is(":checked")!=selectMenu) {
                    $(this).prop("checked", selectMenu).val($(this).val().substr(0,4)+($(this).is(":checked")?"1":"0"));
                }
            });
        }
    });
</script>
</th:block>
</body>
</html>